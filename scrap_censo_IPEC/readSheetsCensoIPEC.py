from google.oauth2.credentials import Credentials
from googleapiclient.discovery import build
from google.oauth2 import service_account
import os
import pandas as pd

df=[]

SCOPES = ['https://www.googleapis.com/auth/spreadsheets']

directorio_actual= os.path.dirname(os.path.abspath(__file__))

ruta_carpeta_guardado = os.path.join(directorio_actual, 'files')

archivo_KEY = os.path.join(ruta_carpeta_guardado, 'key.json')

spreadsheets_ID= '1IBOsYSVDWs9Tz1BN0OlGOZpTsoRNwmiurFJFg__L5ao'

creds = service_account.Credentials.from_service_account_file(archivo_KEY, scopes=SCOPES)

service= build('sheets', 'v4', credentials=creds)

sheet = service.spreadsheets()

result = sheet.values().get(spreadsheetId=spreadsheets_ID, range='Hoja 1').execute()

values = result.get('values', [])[2:]

df = pd.DataFrame(values, columns=['Id_Departamento','Departamento','Poblacion 2010', 'Poblacion 2022', 'Variacion absoluta', 'Variacion relativa', 'Superficie en KM2', 'Densidad de habitantes', 'Poblacion 2022 mujer (excluye situacion de calle)', 'Poblacion 2022 varon (excluye situacion de calle)', 'Indice de feminidad', 'Poblacion en viviendas particulares', 'Poblacion en viviendas particulares con techo con revestimiento interior o cielorraso', 'Poblacion en viviendas particulares con pisos con revestimiento', 'Población en viviendas particulares con pisos con Carpeta, contrapiso o ladrillo fijo', 'Población en viviendas particulares con pisos con Tierra o ladrillo suelto', 'Población en viviendas particulares con pisos con Otro material', 'Población en viviendas particulares con procedencia del agua por cañería dentro de la vivienda', 'Población en viviendas particulares con procedencia del agua Fuera de la vivienda, pero dentro del terreno', 'Población en viviendas particulares con procedencia del agua Fuera del terreno', 'Población en viviendas particulares con provisión de agua por red pública (agua corriente)', 'Población en viviendas particulares en los que el desagüe del inodoro del baño es a red pública (cloaca)', 'Desagüe y descarga de agua del inodoro: A red pública (A cámara séptica y pozo ciego)', 'Desagüe y descarga de agua del inodoro:  Solo a pozo ciego', 'Desagüe y descarga de agua del inodoro:  A hoyo, excavación en la tierra, etc', 'Desagüe y descarga de agua del inodoro: No tiene', 'Población en viviendas particulares que utiliza gas + electricidad para cocinar', 'Población en viviendas particulares que utiliza principalmente para cocinar electricidad', 'Población en viviendas particulares que utiliza principalmente para cocinar gas de red', 'Población en viviendas particulares que utiliza principalmente para cocinar: Gas en tubo o a granel (zeppelin)', 'Población en viviendas particulares que utiliza principalmente para cocinar gas en garrafa', 'Población en viviendas particulares que utiliza principalmente para cocinar leña o carbón', 'Población en viviendas particulares que utiliza principalmente para cocinar otro combustible', 'Población en viviendas particulares cuya vivienda es propia', 'Población en viviendas particulares cuya vivienda es alquilada', 'Población en viviendas particulares cuya vivienda es cedida por trabajo', 'Población en viviendas particulares cuya vivienda es prestada', 'Población en viviendas particulares cuya vivienda es otra situación', 'Tiene internet en la vivienda: Tiene computadora, tablet, etc', 'Tiene internet en la vivienda: No tiene computadora, tablet, etc', 'No tiene internet en la vivienda: Tiene computadora, tablet, etc', 'No tiene internet en la vivienda:  No tiene computadora, tablet, etc', 'Tiene internet en la vivienda: Tiene celular con internet', 'Tiene internet en la vivienda: No tiene celular con internet', 'No tiene internet en la vivienda: Tiene celular con internet', 'No tiene internet en la vivienda: No tiene celular con internet', 'Población en vivienda: Percibe solo jubilación', 'Población en vivienda: Percibe solo pensión por fallecimiento', 'Población en vivienda: Percibe Jubilación y pensión por fallecimiento', 'Población en vivienda: Percibe solo pensión de otro tipo', 'Población en vivienda: No percibe ni jubilación ni pensión', 'Población en vivienda: Obra Social o prepaga (incluye PAMI)', 'Población en vivienda: Programas o planes estatales de salud', 'Población en vivienda: No tiene obra social, prepaga ni plan estatal', 'Población en viviendas particulares: Población que que asiste a escuelas', 'Población en viviendas particulares: Población que que no asiste pero asistió a escuelas', 'Población en viviendas particulares: Población que nunca asistió a escuelas', 'Población en viviendas particulares que asiste a escuelas: nivel educativo Jardin maternal, guardería, centro de cuidado, salas de 0 a 3', 'Población en viviendas particulares que asiste a escuelas: nivel educativo sala de 4 o 5 años', 'Población en viviendas particulares que asiste a escuelas: nivel educativo primario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo secundario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo terciario no universitario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo universitario de grado', 'Población en viviendas particulares que asiste a escuelas: nivel educativo posgrado', 'Población en viviendas colectivas(¹)', 'Edad mediana población', 'Edad mediana mujer', 'Edad mediana varón', '2022 Índice de envejecimiento (total de personas de 65 años o más / total de personas de 0 a 14 años de edad)*100', '2010 Índice de envejecimiento (total de personas de 65 años o más / total de personas de 0 a 14 años de edad)*100', '2022 índice de dependencia potencial ( total de personas de 0 a 14 + total de personas de 65 o más)/personas de 15 a 64)', '2010 índice de dependencia potencial ( total de personas de 0 a 14 + total de personas de 65 o más)/personas de 15 a 64)', 'Población de 80 años y más', 'Total de viviendas 2022', 'Viviendas particulares 2022', 'Viviendas particulares 2010', 'Variación viv part abs 2022-2010', 'Variación viv part rel 2022-2010', 'Viviendas particulares Hay personas presentes', 'No hay personas presentes. La vivienda se usa para vacaciones, fin de semana, como segunda residencia u otro uso temporal', 'No hay personas presentes. La vivienda se usa como oficina, consultorio o comercio', 'No hay personas presentes. La vivienda está en alquiler o venta', 'No hay personas presentes. La vivienda está en construcción', 'No hay personas presentes. Habitualmente viven personas, pero no se encuentran presentes', 'No hay personas presentes. Otra situación', 'Viviendas colectivas', 'Vivienda particular con personas presentes. Tipo de vivienda: Casa', 'Vivienda particular con personas presentes. Tipo de vivienda: Rancho', 'Vivienda particular con personas presentes. Tipo de vivienda: Casilla', 'Vivienda particular con personas presentes. Tipo de vivienda: Departamento', 'Vivienda particular con personas presentes. Tipo de vivienda: Pieza ocupada en inquilinato, hotel familiar o pensión', 'Vivienda particular con personas presentes. Tipo de vivienda: Local no construido para habitación ocupado', 'Vivienda particular con personas presentes. Tipo de vivienda: Vivienda móvil ocupada (casa rodante, barco, carpa u otra)', 'Total de hogares', 'Hogares en Viviendas particulares con pisos con revestimiento', 'Hogares en Viviendas particulares con pisos con Carpeta, contrapiso o ladrillo fijo', 'Hogares en  Viviendas particulares con pisos con Tierra o ladrillo suelto', 'Hogares en  Viviendas particulares con pisos con Otro material', 'Hogares en viviendas particulares con proedencia del agua por cañería dentro de la vivienda', 'Hogares en viviendas particulares con proedencia del agua fuera de la vivienda pero dentro del terreno', 'Hogares en viviendas particulares con proedencia del agua fuera del terreno', 'Región', 'Tasa de empleo', 'Tasa de desocup', 'Tasa de actividad', 'Cateogría ocupacional: Servicio doméstico', 'Categoría Ocupacional: Empleada(o) u obrera(o)', 'Categoría Ocupacional: Cuenta propia', 'Categoría Ocupacional: Patrón(a) o empleador(a)', 'Categoría Ocupacional: Trabajador(a) familiar', 'Categoría Ocupacional: Ignorado', 'Población que asiste a institución educativa', 'Población que no asiste pero asistió a inst educativa', 'Población que nunca asistió a inst educativa', 'Población en viviendas particulares que asiste a escuelas: nivel educativo Jardin maternal, guardería, centro de cuidado, salas de 0 a 3', 'Población en viviendas particulares que asiste a escuelas: nivel educativo sala de 4 o 5 años', 'Población en viviendas particulares que asiste a escuelas: nivel educativo primario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo secundario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo terciario no universitario', 'Población en viviendas particulares que asiste a escuelas: nivel educativo universitario de grado', 'Población en viviendas particulares que asiste a escuelas: nivel educativo posgrado', 'Mujeres de 14 a 49 años en viviendas particulares', 'Mujeres de 14 a 49 años con al menos 1 hijo nacido vivo', 'Promedio de hijos por mujer', 'Población en vivienda: Obra Social o prepaga (incluye PAMI)', 'Población en vivienda: Programas o planes estatales de salud', 'Población en vivienda: No tiene obra social, prepaga ni plan estatal'])

print(df)